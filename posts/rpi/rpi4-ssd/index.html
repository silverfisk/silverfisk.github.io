<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Tom"><meta name=description content="https://linux-konsult.com"><meta name=keywords content="blog,devops,sustainability,esp8266,prometheus,grafana"><meta property="og:site_name" content="linux-konsult.com"><meta property="og:title" content="
  Migrate Raspberry Pi SD card to SSD - linux-konsult.com
"><meta property="og:description" content="Step by step migration instructions"><meta property="og:type" content="website"><meta property="og:url" content="https://linux-konsult.com/posts/rpi/rpi4-ssd/"><meta property="og:image" content="https://linux-konsult.com/img/rpi-logo.png"><meta name=twitter:card content="summary"><meta name=twitter:site content="https://linux-konsult.com/posts/rpi/rpi4-ssd/"><meta name=twitter:image content="https://linux-konsult.com/img/rpi-logo.png"><base href=https://linux-konsult.com/posts/rpi/rpi4-ssd/><title>Migrate Raspberry Pi SD card to SSD - linux-konsult.com</title><link rel=canonical href=https://linux-konsult.com/posts/rpi/rpi4-ssd/><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.2.0/css/all.css integrity=sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ crossorigin=anonymous><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700"><link rel=stylesheet href=/css/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=alternate href=https://linux-konsult.com/index.xml type=application/rss+xml title=linux-konsult.com><link href=https://linux-konsult.com/index.xml rel=feed type=application/rss+xml title=linux-konsult.com><meta name=generator content="Hugo 0.107.0"></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>linux-konsult.com</a>
<input type=checkbox id=menu-control>
<label class="menu-mobile float-right" for=menu-control><span class="btn-mobile float-right">&#9776;</span><ul class=navigation-list><li class="navigation-item align-center"><a class=navigation-link href=https://linux-konsult.com/posts>Blog</a></li><li class="navigation-item align-center"><a class=navigation-link href=https://linux-konsult.com/projects>Projects</a></li><li class="navigation-item align-center"><a class=navigation-link href=https://linux-konsult.com/links>Links</a></li><li class="navigation-item align-center"><a class=navigation-link href=https://whoami.linux-konsult.com>Resume</a></li></ul></label></section></nav><div class=content><section class="container post"><article><header><h1 class=title>Migrate Raspberry Pi SD card to SSD</h1><h2 class=date>July 30, 2022</h2></header><p>Disk intensive applications such as kubernetes can run on Raspberry Pi 4, but you need to migrate from the SD card to an SSD drive.</p><p>Raspberry Pi can boot from USB, so you don&rsquo;t have to wear out your SD card anymore.</p><div class=portfolio><div class=portfolio-inner><div class=portfolio-image><img src=/img/rpi4-ssd.jpeg alt=Hardware></div><div class=portfolio-content><p>This is what you need to configure your raspberry pi:</p><ul><li>A USB3 SATA or M.2 case</li><li>SSD disk</li><li>Os already installed on the old SD card</li></ul></div></div></div><h2 id=set-up>Set up</h2><p>Boot up your rpi4 on the SD card. Log in and connect the USB drive and check out your device names:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pi@raspberrypi:~ $ lsblk 
</span></span><span class=line><span class=cl>NAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
</span></span><span class=line><span class=cl>sda           8:0    0 111.8G  0 disk 
</span></span><span class=line><span class=cl>|-sda1        8:1    0   256M  0 part 
</span></span><span class=line><span class=cl>`-sda2        8:2    0  29.6G  0 part 
</span></span><span class=line><span class=cl>mmcblk0     179:0    0  29.8G  0 disk 
</span></span><span class=line><span class=cl>|-mmcblk0p1 179:1    0   256M  0 part /boot
</span></span><span class=line><span class=cl>`-mmcblk0p2 179:2    0  29.6G  0 part /
</span></span><span class=line><span class=cl>pi@raspberrypi:~ $
</span></span></code></pre></div><p>In this case the USB drive name is <code>sda</code> and <code>mmcblk0</code> is the SD card. If you&rsquo;re unsure, unplug the USB drive and plug it in again so you don&rsquo;t accidentially overwrite your SD card.</p><p>Next steps will erase all data on your SSD (the &ldquo;sda&rdquo; device) and copy your SD card image in one step. You&rsquo;ve been warned.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>pi@raspberrypi:~ $ sudo dd <span class=k>if</span><span class=o>=</span>/dev/mmcblk0 <span class=nv>of</span><span class=o>=</span>/dev/sda <span class=nv>status</span><span class=o>=</span>progress
</span></span></code></pre></div><p>Grow the filesystem</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>pi@raspberrypi:~ $ sudo parted /dev/sda print
</span></span><span class=line><span class=cl>Model:   <span class=o>(</span>scsi<span class=o>)</span>
</span></span><span class=line><span class=cl>Disk /dev/sda: 120GB
</span></span><span class=line><span class=cl>Sector size <span class=o>(</span>logical/physical<span class=o>)</span>: 512B/512B
</span></span><span class=line><span class=cl>Partition Table: msdos
</span></span><span class=line><span class=cl>Disk Flags: 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Number  Start   End     Size    Type     File system  Flags
</span></span><span class=line><span class=cl> <span class=m>1</span>      4194kB  273MB   268MB   primary  fat32        lba
</span></span><span class=line><span class=cl> <span class=m>2</span>      273MB   40.0GB  39.7GB  primary  ext4
</span></span><span class=line><span class=cl>pi@raspberrypi:~ $ <span class=nv>NEWDISKSIZE</span><span class=o>=</span><span class=k>$(</span>sudo parted /dev/sda print <span class=p>|</span> grep ^<span class=s1>&#39;Disk /dev/sda&#39;</span> <span class=p>|</span> awk <span class=s1>&#39;{print $NF}&#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>pi@raspberrypi:~ $ sudo parted /dev/sda resizepart <span class=m>2</span> <span class=si>${</span><span class=nv>NEWDISKSIZE</span><span class=si>}</span>             <span class=c1># Expand filesystem</span>
</span></span><span class=line><span class=cl>pi@raspberrypi:~ $ sudo fsck.ext4 /dev/sda2 
</span></span><span class=line><span class=cl>pi@raspberrypi:~ $ sudo tune2fs /dev/sda2 -L rootfs-SSD                         <span class=c1># Set a new label on the root fs</span>
</span></span><span class=line><span class=cl>pi@raspberrypi:~ $ <span class=nv>OLDUUID</span><span class=o>=</span><span class=k>$(</span>awk <span class=s1>&#39;$2 == &#34;/&#34; {print $1}&#39;</span> /etc/fstab<span class=k>)</span>
</span></span><span class=line><span class=cl>pi@raspberrypi:~ $ sudo mount /dev/sda2 /mnt/
</span></span><span class=line><span class=cl>pi@raspberrypi:~ $ sudo sed -i <span class=s2>&#34;s/</span><span class=si>${</span><span class=nv>OLDUUID</span><span class=si>}</span><span class=s2>/LABEL=rootfs-SSD/g&#34;</span> /mnt/etc/fstab <span class=c1># Mount the label as root in the new fstab</span>
</span></span></code></pre></div><p>Now configure the machine to prioritize USB boot first</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>pi@raspberrypi:~ $ sudo raspi-config
</span></span></code></pre></div><p>Advanced Options > Boot Order > USB Boot</p><p><div class=portfolio><div class=portfolio-inner><div class=portfolio-image><img src=/img/rpi4-stp1.png alt=Step1></div><div class=portfolio-content></div></div></div><div class=portfolio><div class=portfolio-inner><div class=portfolio-image><img src=/img/rpi4-stp2.png alt=Step2></div><div class=portfolio-content></div></div></div><div class=portfolio><div class=portfolio-inner><div class=portfolio-image><img src=/img/rpi4-stp3.png alt=Step3></div><div class=portfolio-content></div></div></div><div class=portfolio><div class=portfolio-inner><div class=portfolio-image><img src=/img/rpi4-stp4.png alt=Step4></div><div class=portfolio-content></div></div></div></p><p>Shut down your raspberry and take out the SD card before powering it on again.</p></article><br></section></div><footer class=footer><section class=container><div class="sns-shares sp-sns-shares"></div><p>Enter a text here.</p></section></footer><div class=fixed-bar><section class=container><p id=privateTriggerText>Contact details <a id=privateTrigger>Click!</a></p><div class="sns-shares pc-sns-shares"></div></section></div></main><script src=/js/app.js></script>
<script>(function(e){e(function(){e("#privateTrigger").on("click",function(){e(".private").slideToggle(),e("#privateTriggerText").text("tom@linux-konsult.com")})})})(jQuery)</script></body></html>